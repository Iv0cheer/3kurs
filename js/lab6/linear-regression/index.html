<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <!-- Import TensorFlow.js from a CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <!-- Import tfjs-vis from a CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
    <link href="./style.css" rel="stylesheet">
</head>

<body>

    <div class="main-centered-container">
        <h1>Создание прогнозной модели на основе линейной регрессии</h1>
        <h2>Изучение основных блоков TensorFlow.js</h2>
        <h3 class="header-border">Введение</h3>
        <p>В этом веб-приложении обучим модель линейной регрессии для прогнозирования пройденного
            расстояния на основе количества сделанных шагов.</p>
        <p>Линейная регрессия — это контролируемый подход(обучение с учителем), который строит модель или строит
            связь между набором независимых переменных
            и одной целевой и непрерывной переменной, то есть переменной,
            значение которой может быть любым числом между минимальным и максимальным значением.</p>
        <p>Набор данных состоит из 198 наблюдений шагов и данных о расстоянии Fitbit. Первая функция, шаги, играет роль независимой,
            в то время как столбец расстояния является целью(целевой функцией), которую хотим предсказать.</p>
        <h3 class="header-border">Загрузка и визуализация данных с помощью tfjs-vis</h3>
        <p>Первый шаг — загрузка данных. После нажатия кнопки
            ниже, загрузим набор данных из локального файла и построим его
            график с помощью tfjs-vis <a href="https://js.tensorflow.org/api_vis/latest/#render.scatterplot"
                target="_blank">scatterplot</a>.
        </p>
        <div id="load-plot"></div>
        <p>
            С правой стороны увидите визор tfjs-vis, отображающий данные, и можно понять, что он очень прост и линеен,
            поскольку темп шагов почти не меняется. Чтобы закрыть
            (или открыть) визор, нажмите кнопку с обратной кавычкой "`".
        </p>
        <p>
            Загрузив данные, приступим к обучению модели.
        </p>
        <h3 class="header-border">Обучение модели</h3>
        <p>
            Чтобы сделать обучение более динамичным, вручную зададим количество эпох,
            то есть количество раз, которое полный набор обучающих данных проходит по модели.
        </p>

        <p>
           Из опыта, 20 эпох достаточно. Данный параметр можно менять, чтобы увидеть
            различные результаты.
        </p>
        <label for="number-epochs">Введите количество эпох (ограничений нет)</label>
        <input type="number" id="number-epochs" name="number-epochs" min="1" value="5" style="width: 5em">
        <h4>Нажмите, чтобы обучить модель</h4>
        <div id="train-div"></div>
        <h3 class="header-border">Визуализация производительности модели</h3>
        <p>
            После начала обучения на визоре увидите две динамические линии,
            которые увеличиваются с течением времени. Эти значения представляют собой
            значение потерь обучения и среднеквадратичную ошибку в
            конце каждой эпохи. В нулевой эпохе обе оценки показывают очень высокое значение,
            но затем после первой эпохи обучения они резко падают из-за простоты набора данных.
        </p>
        <h3 class="header-border">Прогноз</h3>
        <p>
            После завершения обучения проверим на деле модель.
            Чтобы протестировать, введем количество пройденных шагов в поле ниже и выполним прогноз, который определит: какое расстояние было пройдено., нажав «Прогноз!».
            После нажатия кнопки приложение преобразует заданное значение в тензор ранга 1 и вызовет
            функцию <code>predict()</code> для вывода результата. Эта функция возвращает тензор, и для
            его вывода будем использовать <code>dataSync()</code> для синхронного получения результата
            прогноза и отображения его в строке ниже.
        </p>
        <p>
            Помимо прогнозирования, также добавим входное значение и ответ
            на диаграмму рассеивания. Таким образом, получим удобное представление о том,
            насколько точна (или неточна) модель.
        </p>
        <div id="predict"></div>
        <script src="./index.js"></script>
    </div>

</body>

</html>